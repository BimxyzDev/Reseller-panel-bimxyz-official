<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Riwayat â€” Bimxyz Web Cpanel</title>
<style>
body{margin:0;font-family:'Poppins',sans-serif;background:#0d1117;color:#e6e6e6;
display:flex;justify-content:center;align-items:center;flex-direction:column;min-height:100vh;}
.card{background:#161b22;padding:30px;border-radius:12px;width:450px;box-shadow:0 4px 12px rgba(0,0,0,0.5);
max-height:90vh;overflow-y:auto;}
button{width:100%;padding:10px;margin:8px 0;border-radius:8px;border:none;font-weight:bold;cursor:pointer;}
.deleteBtn{background:#da3633;color:#fff;} .deleteBtn:hover{background:#f85149;}
#backBtn{background:#238636;color:#fff;}#backBtn:hover{background:#2ea043;}
</style>
</head>
<body>
<div class="card">
  <h2>Riwayat Server</h2>
  <div id="historyList"></div>
  <button id="backBtn">Kembali</button>
</div>

<script>
if(!localStorage.getItem('username')) location.href='/login';
const list=document.getElementById('historyList');
function render(){
  const history=JSON.parse(localStorage.getItem('serverHistory')||'[]');
  list.innerHTML='';
  if(!history.length){list.innerHTML='<p>Tidak ada riwayat server.</p>';return;}
  history.forEach((e,i)=>{
    const div=document.createElement('div');
    div.style.marginBottom='15px';div.style.borderBottom='1px solid #30363d';div.style.paddingBottom='10px';
    div.innerHTML=`<b>${e.username}</b><br>Password: ${e.password}<br>Panel: <a href="${e.panel}" target="_blank">${e.panel}</a><br>Tanggal: ${e.date}`;
    const del=document.createElement('button');del.className='deleteBtn';del.textContent='Hapus Server';
    del.onclick=async()=>{
      if(!confirm('Yakin hapus server ini?'))return;
      const res=await fetch('/api/server',{method:'POST',headers:{'Content-Type':'application/json'},
      body:JSON.stringify({action:'delete',serverId:e.serverId})});
      const d=await res.json();
      if(d.success){alert('Server dihapus');history.splice(i,1);
      localStorage.setItem('serverHistory',JSON.stringify(history));render();}
      else alert('Gagal: '+d.message);
    };
    div.appendChild(del);list.appendChild(div);
  });
}
backBtn.onclick=()=>location.href='/dashboard';
render();
</script>
</body>
    </html>
